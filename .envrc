# direnv configuration for nr_passkeys_be TYPO3 extension development
# https://direnv.net/
#
# This file is automatically loaded when entering the project directory
# if direnv is installed and allowed.
#
# To allow: direnv allow
# To deny:  direnv deny

# TYPO3 environment
export TYPO3_PATH_ROOT=$PWD/.Build/Web
export TYPO3_PATH_APP=$PWD/.Build
export DDEV_SITENAME="nr-passkeys-be"
export EXTENSION_KEY="nr_passkeys_be"
PATH_add .Build/bin

# Ensure CaptainHook git hooks are installed
if [ -d .git ] && [ -f .Build/bin/captainhook ]; then
    if ! grep -q 'captainhook' .git/hooks/pre-commit 2>/dev/null; then
        echo "Installing CaptainHook git hooks..."
        .Build/bin/captainhook install -c Build/captainhook.json -f
    fi
fi

# Display project info
echo ""
echo "=================================================="
echo "  Passkeys for TYPO3 Backend (nr_passkeys_be)"
echo "=================================================="
echo ""
echo "  Quick Start:"
echo "    make up           - Start DDEV + install all TYPO3 versions"
echo "    make help         - Show all available make targets"
echo ""
echo "  URLs (after make up):"
echo "    https://nr-passkeys-be.ddev.site/           - Landing page"
echo "    https://v13.nr-passkeys-be.ddev.site/typo3/ - TYPO3 v13 Backend"
echo "    https://v14.nr-passkeys-be.ddev.site/typo3/ - TYPO3 v14 Backend"
echo "    https://docs.nr-passkeys-be.ddev.site/      - Documentation"
echo ""
echo "  Credentials:  admin / Joh316!!"
echo ""
echo "  Code Quality:"
echo "    make ci           - Run all local CI checks"
echo "    make lint         - Check code style (PER-CS3.0)"
echo "    make stan         - PHPStan analysis (level 10)"
echo "    make test         - Unit tests"
echo "    make test-e2e     - E2E tests (requires DDEV running)"
echo ""
echo "=================================================="
